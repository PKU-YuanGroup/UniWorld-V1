# we recommend to read config_details.yaml first.


ckpt_path: '../logs/flow/flow_s_1000kx1024_sdvae_disc_ada_drop0p3_dt0p01_complex/checkpoints/1000000.pt' # <---- download our pre-trained dit or your own checkpoint

data:
  data_path: '/storage/lb/checkpoints/LanguageBind/offline_feature/offline_sdvae_256_path/imagenet_train_256' # <---- path to your data. it is generated by extract_features.py.
                                 #       if you just want to inference, download our latent_stats.pt and give its path here is ok.
  fid_reference_file: '/storage/lb/checkpoints/VIRTUAL_imagenet256_labeled.npz' # <---- path to your fid_reference_file.npz. download it from ADM

  # recommend to use default settings
  image_size: 256
  num_classes: 1000
  num_workers: 32
  latent_norm: false
  latent_multiplier: 0.18215

# recommend to use default settings (we wil release codes with SD-VAE later)
vae:
  vae_type: 'sdvae'
  model_path: '/storage/lb/checkpoints/stabilityai/sd-vae-ft-ema/vae-ft-ema-560000-ema-pruned.safetensors'
  downsample_ratio: 8

# recommend to use default settings
model:
  model_type: DiT-S/2
  use_qknorm: true
  use_swiglu: true
  use_rope: true
  use_rmsnorm: true
  in_chans: 4
  use_checkpoint: false

# recommend to use default settings
train:
  max_steps: 1000000
  global_batch_size: 1024
  global_seed: 0
  output_dir: '../logs/flow/flow_s_1000kx1024_sdvae_disc_ada_drop0p3_dt0p01_complex'
  ckpt: null
  log_every: 100
  ckpt_every: 50000
  eval_every: 50000
  wandb: true
  seed: 1234
  precision: 'bf16'
  weight_init: '../logs/flow/flow_s_1000kx1024_sdvae/checkpoints/1000000.pt'
  resume: False
  resume_disc: False
optimizer:
  lr: 0.0002
  beta2: 0.95

discriminator:
  disc_start: 0
  disc_weight: 0.5
  delta_t_for_gt: 0.01
  delta_t_for_pred: 0.01
  disc_factor: 1.0  # 0.0 will disable discriminator adapative weight in gen_step
  disc_model:
    in_c: 4
    dropout: 0.3
    timestep_dim: 512
    complex: true
    complex_model_from: '../logs/flow/flow_s_1000kx1024_sdvae/checkpoints/1000000.pt'
    complex_layer: 2


disc_optimizer:
  lr: 0.0001
  beta2: 0.999
  weight_decay: 0.0001

wandb:
  proj_name: 'flow'
  log_name: 'flow_s_1000kx1024_sdvae_disc_ada_drop0p3_dt0p01_complex'
  key: '953e958793b218efb850fa194e85843e2c3bd88b'
scheduler:
  diffusion: false
  transport: true

diffusion: 
  learn_sigma: true
  diffusion_steps: 1000

# recommend to use default settings
transport:
  path_type: Linear
  prediction: velocity
  loss_weight: null
  sample_eps: null
  train_eps: null
  use_cosine_loss: true
  use_lognorm: true

# recommend to use default settings
sample:
  mode: ODE
  sampling_method: euler
  atol: 0.000001
  rtol: 0.001
  reverse: false
  likelihood: false
  num_sampling_steps: [250, 1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1000]
  cfg_scale: 1.0
  # recommend to use default settings
  per_proc_batch_size: 64
  fid_num: 50000
  cfg_interval_start: 0.0
  timestep_shift: 0.0