training_config:
  wandb_project: "uniworld-v1_1"
  wandb_name: "uniworld_v1_1_3bvlm_stage2_1024_adamw_alllinear_spatok_bagel_demo"
  seed: 203
  output_dir: ./checkpoints/uniworld_v1_1_3bvlm_stage2_1024_adamw_alllinear_spatok_bagel_demo
  logging_dir: ./logs/uniworld_v1_1_3bvlm_stage2_1024_adamw_alllinear_spatok_bagel_demo
  max_train_steps: 400
  optimizer: "adamw"
  learning_rate: 1e-5
  adam_beta1: 0.9
  adam_beta2: 0.99
  adam_epsilon: 1e-8
  adam_weight_decay: 0.0
  mixed_precision: "bf16"
  report_to: "wandb"
  gradient_checkpointing: true
  num_train_epochs: 1
  lr_scheduler: "constant_with_warmup"
  lr_warmup_steps: 100
  lr_num_cycles: 1
  lr_power: 1.0
  resume_from_checkpoint: null
  validation_steps: 1000
  checkpointing_steps: 200
  drop_t5_rate: 1.0
  discrete_timestep: false
  mask_weight_type: 'log'
  gradient_accumulation_steps: 1
  ema_deepspeed_config_file: scripts/accelerate_configs/zero3.json
  ema_decay: 0.999

model_config:
  pretrained_lvlm_name_or_path: /mnt/data/checkpoints/UniWorld_V1_1_Qwen2.5-VL-3B-Instruct_FLUX.1-dev
  pretrained_denoiser_name_or_path: /mnt/data/checkpoints/black-forest-labs/FLUX.1-dev/
  pretrained_siglip_name_or_path: /mnt/data/checkpoints/google/siglip2-so400m-patch16-512
  guidance_scale: 1.0
  only_tune_mlp2: false
  with_tune_mlp2: true
  pretrained_mlp2_path: null
  only_tune_mlp3: false
  with_tune_mlp3: false
  pretrained_mlp3_path: null  
  only_tune_siglip_mlp: false
  with_tune_siglip_mlp: true
  pretrained_siglip_mlp_path: /mnt/data/lb/6.5/UniWorld-V1/checkpoints/flux_redux_1024_zerores_stage2_any15res_resume_ratioemb_lora256/checkpoint-74000/redux/diffusion_pytorch_model.safetensors
  only_use_t5: false
  flux_train_layer_idx: [0]
  vae_fp32: true
  only_tune_image_branch: true
  lora_r_for_lvlm: 256
  lora_all_linear_for_vlm: true
  lora_spacial_embed_tokens: true

dataset_config:
  padding_side: "left"
  ocr_enhancer: false
  dataset_type: qwen2p5vl_v1_1
  min_pixels: 200704
  max_pixels: 200704
  data_txt: /mnt/data/lb/6.5/UniWorld-V1/bagel_demo/bagel_demo.txt
  batch_size: 1
  num_workers: 16
  height: 1024
  width: 1024
  pin_memory: true
  validation_t2i_prompt: "Generate an adorable golden retriever puppy playing in a sunny park, with fluffy fur, big round eyes, and a happy expression. The background should have green grass, some flowers, and a blue sky with white clouds."
  
  validation_it2i_prompt: "Simply reconstruct the original image with no enhancements. <image>"
  validation_image_path: assets/rec.jpg

  validation_iit2i_prompt: "this is a bus image and a on the back of the bus. <image> <image>"
  validation_iit2i_path: ["assets/bus.png", "assets/dog.png"]
  
  validation_cannyt2i_prompt: "Render an image where fine details and textures are filled in based on the provided canny lines, influenced by 'white and black dogs on snow covered ground during daytime'.\n<image>"
  validation_cannyt2i_path: assets/canny.jpg
  
  validation_it2canny_prompt: "Generate a Canny edge map for this image.\n<image>"
  validation_it2canny_path: assets/canny_image.jpg
  
  validation_it2pose_prompt: "Create a pose map using OpenPose.<image>"
  validation_it2pose_path: assets/pose_image.jpg
  
  validation_poset2i_prompt: "Create a person image that conforms to the input pose, with realistic anatomy and appearance related to 'Two individuals sit on a wooden bench in a park, with one person stretching their arms above their head and the other engrossed in their mobile device.'. <image>"
  validation_poset2i_path: assets/pose.jpg
  
  validation_NIKEit2i_prompt: "Switch the product's color from black, black to white, white, making sure the transition is crisp and clear.\n<image>"
  validation_NIKEit2i_path: assets/nike_src.jpg

  validation_TRANSFERit2i_prompt: "Convert an image to Ghibli style. <image>"
  validation_TRANSFERit2i_path: assets/bus.png

  validation_EXTRACTit2i_prompt: "Extract the ny 94 printed cotton-jersey sweatpants from the person, ensuring the image only displays the item without any background distractions. <image>"
  validation_EXTRACTit2i_path: assets/extract_src.jpg

  validation_TRYONit2i_prompt: "Integrate the striped cotton sweater into the person's overall look, making it appear natural and stylish. <image>"
  validation_TRYONit2i_path: assets/extract_dst.jpg

  validation_REPLACEit2i_prompt: "replace motorcycle located in the lower center region of the image with a black bicycle <image>"
  validation_REPLACEit2i_path: assets/replace_src.png

  validation_SEGit2i_prompt: "Segment the giraffe from the background.\n<image>"
  validation_SEGit2i_path: assets/seg_src.jpg

  validation_DETit2i_prompt: "Please detect the vase accurately <image>"
  validation_DETit2i_path: assets/det_src.jpg

  